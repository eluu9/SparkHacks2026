{% extends "base.html" %}

{% block content %}
<div class="container-fluid p-0" style="height: calc(100vh - 60px);"> 
    <div class="row h-100 g-0">
        
        <div class="col-12 col-lg-8 mx-auto d-flex flex-column h-100 position-relative bg-white shadow-sm">
            
            <div id="chat-display" class="flex-grow-1 p-4 px-lg-5" style="overflow-y: auto; scroll-behavior: smooth;">
                
                <div class="d-flex mb-4 pop-animation justify-content-center">
                    <div class="msg-ai p-3 text-center" style="max-width: 80%;">
                        {% if current_user.is_authenticated %}
                            <strong>Welcome back to KARTWISE.AI, {{ current_user.name.split(' ')[0] }}!</strong><br>
                            I'm your shopping orchestrator. Tell me what you need to build.
                        {% else %}
                            <strong>Welcome to KARTWISE.AI!</strong><br>
                            Drop a vibe and a budget, and I'll build you a custom shopping kit.
                        {% endif %}
                    </div>
                </div>

                <div id="loading-bubble" class="d-none pop-animation">
                    <div class="d-flex mb-4">
                        <div class="msg-ai p-3 text-muted fst-italic shadow-sm">
                            <span class="spinner-border spinner-border-sm me-2 text-primary" role="status"></span>
                            <span>Orchestrating your kit... this takes about 5 seconds.</span>
                        </div>
                    </div>
                </div>

            </div>

            <div class="pb-4 pt-2 px-4 bg-transparent">
                <div class="mx-auto" style="max-width: 850px;">
                    <form id="chat-form" class="bg-white shadow-sm rounded-pill p-2 d-flex gap-2 border">
                        <input type="text" 
                               id="user-input" 
                               class="form-control border-0 bg-transparent px-4 shadow-none" 
                               placeholder="Describe your project (e.g. 'Square table for $200')..." 
                               autocomplete="off"
                               required>
                        
                        <button type="submit" class="btn btn-dark pill-btn px-4">
                            Build Kit <i class="bi bi-stars ms-1"></i>
                        </button>
                    </form>
                </div>
            </div>

        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/main.js') }}"></script>
{% endblock %}